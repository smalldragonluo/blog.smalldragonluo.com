title: 浅析上下文无关文法
date: 2015-12-06 22:07:51
tags:
 - 上下文无关文法
 - 编译器
categories: 
 - 前端技术
 - 编译
toc: true
description: 在编译器的分析部分，需要使用一种表示方法用于描述程序语言的语法，上下文无关文法是表示方法中的一种。

---

在编译器的分析部分，需要使用一种表示方法用于描述程序语言的语法，上下文无关文法是表示方法中的一种，被广泛采用。

#### 文法定义

##### 组成要素

一个上下文无关文法由四个元素组成：

 - 一个终结符号集合，终结符号是文法中最基本的符号，可以将其理解为最小的符号，有时也称为词法单元
 - 一个非终结符号集合，又称「语法变量」，是终结符号的集合
 - 一个产生式集合，产生式用来表示某种构造的书写形式，由产生式头，箭头，产生式体组成，稍后会有详细介绍
 - 一个开始符号，此符号为非终结符号

##### 产生式

以 JAVA 语句为例子，一个 if-else 的语句一般是以下形式：

```
if (expr) stmt else stmt
```

上述语句可以用一个产生式表示为：

```
stmt -> if (expr) stmt else stmt
```

这是一个语句的描述，其中 if，else 称为终结符号，可以由一个词法单元表示。expr，stmt 属于非终结符号，因为其可以由另一个产生式表示。

举个简单的例子，接下来通过上下文无关文法描述一个简单的语法--乘除过程 p：

```
p     -> p * digit
p     -> p / digit
p     -> digit
digit -> 0|1|2|3|4|5|6|7|8|9
```

##### 二义性

不合理的文法设计，会导致文法具有二义性，即将其翻译为语法树时，可能会有多颗不同构的树，需要避免。
如下是一个具有二义性的文法：

```
stmt  -> stmt + digit | stmt * digit | digit
digit -> 0|1|2|3|4|5|6|7|8|9
```

对于 `1 + 2 * 3`，可由两颗不同的语法树描述：

![](/assets/1573890502567.jpg)

##### 结合性（优先级）

运算符可能有不同的优先级，例如 * / 优先级高于 + -，对于具有 n 种优先级的情况，我们可以用 n + 1 个非终结符号来表示，其中 n 个非终结符号分别代表不同优先级，一个非终结符号代表基本单元
例如我们可以改造上面的产生式为：

```
stmt   -> stmt  + add   | add
add    -> add   + multi | multi
multi  -> multi * digit | digit
digit -> 0|1|2|3|4|5|6|7|8|9
```

![](/assets/1573892469767.jpg)
